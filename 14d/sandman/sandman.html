<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Sandman - Notas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 900px;
            width: 100%;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.95em;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        button.control-btn {
            padding: 10px 20px;
            font-size: 1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #667eea;
            color: white;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        button.control-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .progress {
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            min-height: 30px;
        }
        
        .notes-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        button.note-btn {
            padding: 25px;
            font-size: 1.3em;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        button.note-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }
        
        button.note-btn:active {
            transform: translateY(-1px);
        }
        
        button.note-btn.correct {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
        }
        
        button.note-btn.error {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        }
        
        .note-name {
            font-size: 0.8em;
            opacity: 0.9;
        }
        
        .note-number {
            font-size: 0.7em;
            opacity: 0.7;
        }
        
        .info {
            text-align: center;
            color: #666;
            font-size: 0.9em;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .success-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            padding: 60px 80px;
            border-radius: 20px;
            font-size: 3em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideIn 0.5s ease;
            z-index: 1000;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ Mr. Sandman</h1>
        <p class="subtitle">Las 13 primeras notas - The Chordettes</p>
        
        <div class="controls">
            <button class="control-btn" onclick="playSequence()">‚ñ∂ Reproducir secuencia</button>
            <button class="control-btn" onclick="stopSequence()">‚èπ Detener</button>
            <button class="control-btn" onclick="resetSequence()">üîÑ Reset</button>
        </div>
        
        <div class="progress" id="progress"></div>
        
        <div class="notes-grid" id="notesGrid"></div>
        
        <div class="info">
            Haz clic en los botones en el orden correcto para completar la secuencia de 13 notas.
        </div>
    </div>

    <script>
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Frecuencias de las notas en Hz
        const noteFrequencies = {
            'fa': 349.23,
            'sol': 392.00,
            'la': 440.00,
            'la#': 466.16,
            'do+': 523.25,
            're+': 587.33,
            'mi+': 659.25,
            'fa+': 698.46
        };
        
        const notes = [
            { name: 'Fa', key: 'fa', number: 1 },
            { name: 'Sol', key: 'sol', number: 2 },
            { name: 'La', key: 'la', number: 3 },
            { name: 'La#', key: 'la#', number: 4 },
            { name: 'Do+', key: 'do+', number: 5 },
            { name: 'Re+', key: 're+', number: 6 },
            { name: 'Mi+', key: 'mi+', number: 7 },
            { name: 'Fa+', key: 'fa+', number: 8 }
        ];
        
        // Secuencia correcta: 1,3,5,7,6,5,3,1,2,4,6,8,7
        const correctSequence = [1, 3, 5, 7, 6, 5, 3, 1, 2, 4, 6, 8, 7];
        let currentProgress = 0;
        let isPlaying = false;
        
        function playNote(frequency, duration = 0.5) {
            const now = audioContext.currentTime;
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            
            osc.connect(gain);
            gain.connect(audioContext.destination);
            
            osc.frequency.value = frequency;
            osc.type = 'sine';
            
            gain.gain.setValueAtTime(0.3, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + duration);
            
            osc.start(now);
            osc.stop(now + duration);
        }
        
        function playNoteByNumber(noteNumber) {
            const note = notes.find(n => n.number === noteNumber);
            if (note) {
                playNote(noteFrequencies[note.key], 0.5);
            }
        }
        
        function checkSequence(noteNumber, clickedBtn) {
            if (noteNumber === correctSequence[currentProgress]) {
                currentProgress++;
                updateProgress();
                
                // Resaltar solo el bot√≥n clicado en verde
                document.querySelectorAll('.note-btn').forEach(btn => {
                    btn.classList.remove('correct', 'error');
                });
                clickedBtn.classList.add('correct');
                setTimeout(() => clickedBtn.classList.remove('correct'), 300);
                
                if (currentProgress === correctSequence.length) {
                    showSuccess();
                }
            } else {
                // Error en rojo
                document.querySelectorAll('.note-btn').forEach(btn => {
                    btn.classList.remove('correct', 'error');
                });
                clickedBtn.classList.add('error');
                setTimeout(() => clickedBtn.classList.remove('error'), 500);
                resetSequence();
            }
        }
        
        function updateProgress() {
            const progressDiv = document.getElementById('progress');
            progressDiv.textContent = `Progreso: ${currentProgress}/${correctSequence.length}`;
        }
        
        function resetSequence() {
            currentProgress = 0;
            updateProgress();
        }
        
        function showSuccess() {
            const message = document.createElement('div');
            message.className = 'success-message';
            message.textContent = '¬°Conseguido!!';
            document.body.appendChild(message);
            
            // Reproducir el mp3
            const audio = new Audio('song.mp3');
            audio.play();
            
            setTimeout(() => {
                message.remove();
                resetSequence();
            }, 3000);
        }
        
        async function playSequence() {
            isPlaying = true;
            for (let i = 0; i < correctSequence.length && isPlaying; i++) {
                playNoteByNumber(correctSequence[i]);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            isPlaying = false;
        }
        
        function stopSequence() {
            isPlaying = false;
        }
        
        // Crear botones
        const grid = document.getElementById('notesGrid');
        notes.forEach((note) => {
            const btn = document.createElement('button');
            btn.className = 'note-btn';
            btn.innerHTML = `
                <span class="note-name">${note.name}</span>
                <span class="note-number">#${note.number}</span>
            `;
            btn.onclick = () => {
                playNoteByNumber(note.number);
                checkSequence(note.number, btn);
            };
            grid.appendChild(btn);
        });
        
        updateProgress();
    </script>
</body>
</html>